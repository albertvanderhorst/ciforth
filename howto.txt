( $ Id: )
( Copyright{2003}: Albert van der Horst, HCC FIG Holland by GNU Public License)

Do a regression test on lina :
    make testlina
and
    lina -e | tee aap
Within Forth :
    CRACK-FROM ONLY BYE

Then
   sed 's/804[0-9A-F,]*/804BLABLA/g' <aap >qqq
   diff qqq officialdecompilation
If approved :
    mv qqq officialdecompilation

Do a regression test on wina :
    make wina.zip
    make testwina
    mcopy wina.zip a:
    mcopy -t testwina.1 testwina.2 a:

How to create a floppy booting into ciforth

make allboot

How to create a hard disk booting into ciforth:
REQUIRE INSTALL-KERNEL    REQUIRE RESTORE-BLOCKS

How to create an official decompilation :
   see regressiontest

How to save blocks from the first chunk to floppy:
has been renamed to BACKUP-BLOCKS (was SAVE-BLOCKS)
2001 sep 1

How to do the Johns Hopkins university test
lina <tsuite.frt
Is now incorporated into test.mak
make testlina

How to find the search ORDER
REQUIRE ORDER

How to save a system
REQUIRE SAVE-SYSTEM
"aap" SAVE-SYSTEM

How to install a kernel on hard disk
Boot from version created by alone.cfg
28 LOAD
REQUIRE INSTALL-KERNEL
RESTORE-BLOCKS    \ If you want these blocks on hd too
INSTALL-KERNEL    \ Insert floppy with kernel

How to load a VOCABULARY / NAMESPACE high:
???
2001 oct 9

How to create a distribution :
   It is important to do
   make clean
   rm VERSION
   This is done automatically only for LINAZIP

AN OFFICIAL RELEASE IS GENERATED BY PASSING A VERSION MACRO
WITH A DECIMAL POINT TO  make.

Other VERSION or no VERSION means it is a beta.

   Release generic version, official
   make zip VERSION=4.0
   Result in ciforth-4.0.tar.gz

   Release generic version, beta
   make zip VERSION=3d286
   Result in ciforth-3d286.tar.gz (not yet)
   Or use $V.

   Release Linux version, official (same for LINA64ZIP)
   make clean
   make LINA32ZIP VERSION=4.0
   Result in lina-4.0.tar.gz

   Release Linux version, snapshot date version
   make clean
   make VERSION # Based on date
   make LINA32ZIP
   Result in lina-2004mar18.tar.gz

   Release Linux version, beta
   make clean
   make LINA32ZIP VERSION=3d286
   Result in lina-2d286.tar.gz
   Or use $V from setenv equal to latest rcs name of ci86.gnr

   Release mina / wina
   Use
   releasemina.bat 4d0
   releasemina.bat 3d275
   releasewina.bat 4d0
   releasewina.bat 3d275

How to patch, say release 4.0.2

Make sure there is a branch rel-4-0-patches
Get it. Because you want to make 4.0.2
apparently you will get 4.0.2 plus maybe some patches
already made.
Before release, call this version 4.0.3.
From then on 4.0.2 can no longer be patched.

2003 sep 04
How to move a sticky tag to a new branch:
In this example from 4.15.2.5 to 4.15.3.1

Just use rcs to do this:
ln -s $CVSROOT/ciforth RCS
NEWBRANCH=4.15.0.3
co -l -rrel-4-0-patches $f
cvs diff $f     # check : no diffs
ci -f -r$NEWBRANCH $f
rcs -Nrel-4-0-patches $f
rcs -Nrel-4-0-patches:$NEWBRANCH $f
rm RCS
cvs diff $f     # check : no diffs

2003 oct 13

Howto install an info file :
This inserts a finder for lina into the topmost hierarchy of info.
But also copies the file to where it can find it.

cp lina.info /usr/share/info
install-info --entry='* lina :: a simple Linux native Forth implementation' \
             lina.info /usr/share/info/dir

2004 sep 16
How to make an xp distro for Simtel
        make a normal windows distribution
        update the README.xp file
        make an executable with the correct default shell, by editing the asm file
        copy the distribution to wna4x0x#
        replace executable and README.wina in the a copy of the distro

2010 aug 17
How to make a 64 bit release.
rm VERSION
make lina64.zip VERSION=beta-5-63
Now the executable has to be build on a 64 bit system, because the
executable generated on Suse 32 bit, doesn't run.
as -64 lina64.s
ld -s -N a.out -o lina64

2012 aug 31
How to make a 64 bit wina.
make ci86.wina64.fas
fasm ci86.wina64.fas -M300000

2012 sep 2
A 64 bit release can be made on a 32 bit system if fasm is used.
make ci86.lina64.fas
fasm ci86.lina64.fas
mv ci86.lina64 ci86.lina64

2012 sep 20
The 64 version is now made using fasm, so
make lina64
uses fasm
`` make glina64 '' uses gas and works only on a 64 bit system.

2012 nov 6
Make a dpmi version by
releasedpmi.bat
A windows dll version is henceforth made by the old releasewina.bat

2013 mar 12
Generate a regressiontest for xina:
make testxina.

2014 jun 12
From now on use
make lina32.zip
(not make lina64.zip)

2015 jan 7
releasing xina
Use `` . setenv '' to set $V
. releasexina.bat $V
result in xina-$V.tar
2015 jun2
The lina32.zip target is replaced by symbolic LINA32ZIP.
The lina64.zip target is replaced by symbolic LINA64ZIP.

2017 nov
Get a local version of a repository.
This will at the same time check everything out into a working
directory.

git init
git pull https://github.com/albertvanderhorst/ciforth master

Reinitialize somewhat

git reset --hard
This may give a message that there are two HEAD's , but it
still worked.

2018 feb 19
Recapitulation in order to built a source/bin archive for
version 5.6.7 :

make VERSION=5.6.7 clean VERSION LINA32ZIP

2022 mar 4
For usage of git see readme's in the .bin directory.
2022 mar 5
Make a generic source archive with
``make zip VERSION=#.#.#'' generates an archive that makes lab's, executable's
and perform
make testlina32 testlina64 testwina32 testwina64.

2022 mar 7

Release for the user/advanced user, as before, but with source of
the program and the source of the documentation.
make VERSION=5.6.7 clean VERSION LINA32ZIP
make VERSION=5.6.7 clean VERSION LINA64ZIP

# not functional
Release of the full source, but also ready to run.
make VERSION=5.6.7 clean VERSION LINA32SRC_M4
make VERSION=5.6.7 clean VERSION LINA64SRC_M4

OBSOLETE- OBSOLETE- OBSOLETE- OBSOLETE- OBSOLETE- OBSOLETE- OBSOLETE-
2022 mar 13
To make a source archive that can be converted to a debian
archive.
make VERSION=5.6.7 clean VERSION LINA64dDEB
- unpack the source archive giving lina64_#.#.#
- run debmake from within
- replace debian/ with an unpacked debianE.tar
- run debuild from within
You get an debian archive and some stuff that can be uploaded
in principle  ..orig..xz and ..#.#.#-1..xz
OBSOLETE- OBSOLETE- OBSOLETE- OBSOLETE- OBSOLETE- OBSOLETE- OBSOLETE-

2022mar 22
OFficial releases
releasewina.bat works as follows
    $1 wina32/wina64
    $2 9.8.7

make clean VERSION VERSION=5.4.0 LINA64ZIP

Result in ci86.lina64-$(VERSION).tar.gz

2022dec 27

To make a source archive that can be converted to a debian
archive.
make VERSION=5.6.7 clean VERSION LINA64ZIP
Follow the instructions in debbuild.sh

2023apr 21
releasewina64.bat is obsolete, use releasewina.bat.
